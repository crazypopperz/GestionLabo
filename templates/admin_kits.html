<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Gestion des Kits de Réservation</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="{{ url_for('static', filename='js/script.js') }}" defer></script>
</head>
<body>
    {% include 'header.html' %}
    <div class="main-container">

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="flash-messages">
                {% for category, message in messages %}
                    <div class="flash {{ category }}">{{ message }}</div>
                {% endfor %}
                </div>
            {% endif %}
        {% endwith %}
		
		{% include '_breadcrumb.html' %}

        <div class="management-header">
            <h2 class="page-title">
                <svg xmlns="http://www.w3.org/2000/svg" class="page-title-icon" viewBox="0 -960 960 960"><path d="M756-120 537-339l84-84 219 219-84 84Zm-552 0-84-84 276-276-68-68-28 28-51-51v82l-28 28-121-121 28-28h82l-50-50 142-142q20-20 43-29t47-9q24 0 47 9t43 29l-92 92 50 50-28 28 68 68 90-90q-4-11-6.5-23t-2.5-24q0-59 40.5-99.5T701-841q15 0 28.5 3t27.5 9l-99 99 72 72 99-99q7 14 9.5 27.5T841-701q0 59-40.5 99.5T701-561q-12 0-24-2t-23-7L204-120Z"/></svg>
                <span>Gestion des Kits de Réservation</span>
            </h2>
        </div>
        
        <div class="page-actions-container">
            <button class="btn-action" data-modal-trigger="add-kit-modal">Créer un nouveau kit</button>
        </div>

        <div class="card-container management-page">
            {% for kit in kits %}
            <div class="item-card">
                <div class="card-info">
                    <a href="{{ url_for('admin.modifier_kit', kit_id=kit.id) }}" class="card-title-link">
                        <span class="card-title"><strong>{{ kit.nom }}</strong></span>
                    </a>
                    <span class="card-description">{{ kit.description }}</span>
                    <span class="card-count">
						{% if kit.count == 0 %}Aucun objet
						{% elif kit.count == 1 %}1 objet
						{% else %}{{ kit.count }} objets
						{% endif %}
					</span>
                </div>
                <div class="card-actions">
                    <a href="{{ url_for('admin.modifier_kit', kit_id=kit.id) }}" title="Modifier le kit">
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"><path d="M167-120q-21 5-36.5-10.5T120-167l40-191 198 198-191 40Zm191-40L160-358l458-458q23-23 57-23t57 23l84 84q23 23 23 57t-23 57L358-160Zm317-600L261-346l85 85 414-414-85-85Z"/></svg>
                    </a>
                    <button type="button" class="btn-danger btn-open-danger-modal"
							data-action="{{ url_for('admin.supprimer_kit', kit_id=kit.id) }}"
							data-message="Êtes-vous sûr de vouloir supprimer le kit '{{ kit.nom }}' ?">
						Supprimer
					</button>
                </div>
            </div>
            {% else %}
                <p>Aucun kit n'a été créé pour le moment.</p>
            {% endfor %}
        </div>
    </div>

    <!-- Modale pour ajouter un nouveau kit -->
    <div id="add-kit-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title-with-icon">Créer un nouveau kit</h3>
                <button class="close-btn">×</button>
            </div>
            <form action="{{ url_for('admin.ajouter_kit') }}" method="post" class="modal-form">
			<input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
				<div class="form-group">
					<label for="nom">Nom du kit :</label>
					<input type="text" id="nom" name="nom" required placeholder="Ex: Kit TP Chimie N°5">
				</div>
				<div class="form-group">
					<label for="description">Description (optionnel) :</label>
					<textarea id="description" name="description" rows="3" placeholder="Ex: Matériel nécessaire pour la manipulation sur les acides-bases."></textarea>
				</div>
				<div class="modal-actions">
					<button type="button" class="btn-action">Annuler</button>
					<button type="submit" class="btn-action">Créer et configurer</button>
				</div>
			</form>
        </div>
    </div>

    {% include 'footer.html' %}
	{% include '_modale_danger.html' %}
</body>
</html>