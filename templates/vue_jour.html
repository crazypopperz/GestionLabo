<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Réservations pour le {{ date_concernee | strftime_fr('%A %d %B %Y') }}</title>
    <meta name="csrf-token" content="{{ csrf_token() }}">
	<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="{{ url_for('static', filename='js/script.js') }}" defer></script>
</head>
<body data-is-admin="{{ 'true' if session.user_role == 'admin' else 'false' }}" data-user-id="{{ session.user_id }}">
    {% include 'header.html' %}
    <div class="main-container">
        <div class="management-header-split">
            <div class="page-title">
                <svg class="page-title-icon" xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" viewBox="0 0 24 24"><g><rect fill="none" height="24" width="24"/></g><g><g><polygon points="10,8 10,14 14.7,16.9 15.5,15.7 11.5,13.3 11.5,8"/><path d="M17.92,12c0.05,0.33,0.08,0.66,0.08,1c0,3.9-3.1,7-7,7s-7-3.1-7-7c0-3.9,3.1-7,7-7c0.7,0,1.37,0.1,2,0.29V4.23 C12.36,4.08,11.69,4,11,4c-5,0-9,4-9,9s4,9,9,9s9-4,9-9c0-0.34-0.02-0.67-0.06-1H17.92z"/><polygon points="20,5 20,2 18,2 18,5 15,5 15,7 18,7 18,10 20,10 20,7 23,7 23,5"/></g></g></svg>
                <span>Réservations pour le {{ date_concernee|strftime_fr('%A %d %B %Y') }}</span>
            </div>
            <div class="page-actions">
                <button id="new-reservation-btn" class="btn-action">Nouvelle Réservation</button>
            </div>
        </div>

        <div class="content-card">
            <div class="daily-schedule">
                {% for hour in range(8, 21) %}
                <div class="schedule-slot">
                    <div class="time-label">{{ "%02d:00"|format(hour) }}</div>
                    <div class="events-container">
                        {% set events = reservations_par_heure.get(hour, {}) %}
                        {% if events['starts'] or events['continues'] %}
                            {% for resa in events['continues'] %}
                            <div class="event-block continuation" data-groupe-id="{{ resa.groupe_id }}">
                                <div class="event-user">(Suite) {{ resa.nom_utilisateur }}</div>
                            </div>
                            {% endfor %}
                            {% for resa in events['starts'] %}
                            <div class="event-block" data-groupe-id="{{ resa.groupe_id }}">
                                <div class="event-time">
                                    {{ resa.debut_reservation|strftime('%H:%M') }} - {{ resa.fin_reservation|strftime('%H:%M') }}
                                </div>
                                <div class="event-user">{{ resa.nom_utilisateur }}</div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="no-event-placeholder"></div>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
			</div>
        </div>
    </div>

    <div id="reservation-tooltip" class="tooltip"></div>

    {% include '_modals.html' %} 
    {% include 'footer.html' %}

    {% block scripts %}
        <script src="{{ url_for('static', filename='modules/booking-modal.js') }}" type="module"></script>
        <script src="{{ url_for('static', filename='modules/calendar-daily.js') }}" type="module"></script>
    {% endblock %}
</body>
</html>